import csv
import sys
import os

# Data to append/update
new_article = {
    "slug": "agent-multiple-registration-tips",
    "title": "【2026年版】フリーランスエージェントの賢い立ち回り｜囲い込みを回避し単価を上げる",
    "description": "【2026年最新版】エージェントの「囲い込み」は珍しくありません。他社状況を聞く理由、複数登録はバレるのか、バッティング回避策、最適な併用社数まで実務視点で解説します。",
    "content": """![フリーランスエージェントの賢い立ち回り](/images/articles/029.png)

## 結論：複数登録は必須。主導権はエンジニア側が持つ

「他社の選考状況はいかがですか？」「できれば弊社一本で進めていただけませんか？」
フリーランスがエージェントとやり取りしていると、高確率で聞かれるフレーズです。親身に見えますが、実態としては**囲い込み（自社経由での成約を固定化したい動き）**の一環であることも少なくありません。

結論として、**フリーランスの複数エージェント登録はマナー違反ではなく、むしろ必須のリスクヘッジ**です。
1社に寄せるほど、単価・案件の質・担当者リスクをまとめて背負うことになります。

冒頭の段階で「信頼できるパートナー探し」をしておきたい方は、**条件の透明性を重視するFreelanceBox**のような窓口も併用しておくと、比較軸が作りやすくなります。

---

## エージェントが行う「囲い込み」の正体と裏事情

### なぜ「専任」にしたがるのか？（営業KPIと機会損失）

エージェントは、あなたが**参画して初めて売上が立つ**ビジネスです。
どれだけ長く面談しても、他社経由で決まれば自社の売上はゼロ。担当者のKPI（面談設定数・成約数・粗利）にも直撃します。

そのため、囲い込みトークが出やすくなります。

*   「複数社だと調整が大変ですよ」
*   「この枠は特別なので、まず弊社で」
*   「他社はやめた方がいいです」

一部は事実でも、基本は**自社の成約率を上げるためのポジショントーク**だと理解しておくと冷静に判断できます。

### 「他社の状況を教えてください」の本当の意味（価格と進捗の管理）

他社状況を聞く目的は主に2つです。

*   **進捗管理**：競合に負ける前にスピードを上げたい
*   **価格調整**：他社の提示額を見て、自社の提示を最適化したい

つまり「親切だから聞いている」だけではなく、**交渉材料を取りに来ている**側面があります。

---

## 複数登録はマナー違反ではない【3つのメリット】

### 1. 市場価値が「可視化」される（単価が普通にブレる）

同じスキルでも、A社60万・B社80万のように**提示単価が5〜10万円以上ズレる**ことは珍しくありません。
理由はマージン率・商流・クライアントとの力関係の差です。複数社で相見積もりを取ることで、相場が見えます。

### 2. 商流の違いで「案件の質」が変わる

エージェントごとに得意領域が違います。

*   直請けが多い
*   二次請け中心
*   金融に強い / Webに強い など

1社固定だと、その会社の“色”の範囲でしか選べません。

### 3. リスク分散（担当者ガチャを回避）

レスが遅い、希望が通らない、雑な担当者に当たると、案件探し自体が止まります。
複数社併用は、**担当者リスクの分散**でもあります。

---

## 複数エージェント併用時の「賢い立ち回り」と手順

### 登録時は「正直に言う」が正解

聞かれたら、こう返せばOKです。

*   「比較検討のために2〜3社併用しています」
*   「条件面をフェアに判断したいので、複数で進めています」

社名まで言う必要はありません。「大手含め数社」で十分です。
隠すより、**競争原理を働かせて優先度を上げる**方が得です。

### 面談調整：主導権を渡さない

複数社を使うと、調整で消耗します。ルールを決めましょう。

*   面談可能枠を週2〜3コマに固定
*   先に“出せる日程”だけ提示（相手に選ばせすぎない）
*   口頭で即決しない（持ち帰るのが基本）

### バッティング回避：エントリー前の「重複確認」は必須

最悪の事故が**同一案件への二重応募**です。クライアント側に嫌われ、即終了のこともあります。

鉄則はこれだけです。
**「エントリー前に、発注元（エンド）を特定できる情報を確認する」**

言い方はシンプルでOKです。
*   「重複応募を避けたいので、発注元（エンド）か案件IDを確認できますか？」

これを拒む・濁す場合は、商流が深い／情報非開示体質の可能性が高いので注意です。

---

## 要注意！「悪い囲い込み」をするエージェントの特徴

### 案件詳細（エンド企業名）をなかなか明かさない

「面談が決まるまで企業名は出せません」が常態化している場合、要警戒です。
バッティング防止ができず、エンジニア側だけリスクを負います。

### 「今すぐ決めないと枠が埋まる」と過度に煽る

スピード感は大事ですが、過度な煽りは囲い込みの定番です。
比較検討の時間を奪われると、条件で損をしやすくなります。

### 契約更新時に、他社への乗り換えを過剰に牽制する

「更新しないなら今後紹介できません」など、過剰な圧をかけるのは危険信号です。

---

## まとめ：エージェントに使われるな、使いこなせ

*   複数登録は当たり前（**2〜3社**が最適解）
*   他社利用は隠さず伝える（競争させる）
*   企業名（発注元）確認でバッティングを防ぐ

この3点を守れば、囲い込みに振り回される確率は一気に下がります。

---

### FreelanceBoxへの登録・相談導線

「提案単価が伸びない」「情報が開示されず不信感がある」と感じたら、エージェントの見直しタイミングです。FreelanceBoxでは、**透明性の高い条件開示**と**直請け・高単価案件**を軸に、囲い込みに頼らない案件提案を行っています。まずは市場価値の確認だけでも、お気軽にご相談ください。""",
    "category": "Agent",
    "tags": "フリーランスエージェント,エージェント活用法,複数登録,商流,単価交渉,トラブル対策,案件探し,SES業界の裏側",
    "faq": "Q:複数のエージェントに登録していることは伝えたほうがいいですか？|A:はい、伝えるのが基本です。比較していると伝えることで優先度が上がり、単価交渉もしやすくなります。;Q:エージェントは何社くらい登録するのが一般的ですか？|A:管理負荷と分散のバランスから2〜3社が一般的です。メイン1社＋サブ2社が運用しやすいです。;Q:専任でお願いしますと言われたらどう断ればいいですか？|A:より良い選択肢から判断したいので複数社で検討している、と丁寧に伝えて問題ありません。;Q:同じ案件が複数社から来たらどうすればいいですか？|A:先にエントリーした経路を優先し、後から来た方は丁寧に断ります。二重応募は避けてください。;Q:企業名を教えてくれないエージェントは怪しいですか？|A:注意が必要です。商流が深い・情報非開示体質の可能性があり、バッティング回避ができません。",
    "thumbnail_url": "/images/articles/029.png",
    "status": "published",
    "published_at": "2026-01-26 10:00:00"
}

file_path = 'articles_data.csv'
header = ["slug", "title", "description", "content", "category", "tags", "faq", "thumbnail_url", "status", "published_at"]

# deduplicate and upsert
rows_by_slug = {}
order = []

try:
    if os.path.exists(file_path):
        with open(file_path, 'r', encoding='utf-8') as f:
            reader = csv.DictReader(f)
            for row in reader:
                s = row.get('slug', '').strip()
                if s: 
                    # basic safety check
                    if len(row) < 5: continue
                    
                    if s not in rows_by_slug:
                        order.append(s)
                    rows_by_slug[s] = row
    
    # Update or Append
    slug = new_article['slug']
    if slug not in rows_by_slug:
        order.append(slug)
    rows_by_slug[slug] = new_article

    # Write back
    with open(file_path, 'w', encoding='utf-8', newline='') as f:
        writer = csv.DictWriter(f, fieldnames=header)
        writer.writeheader()
        for s in order:
            writer.writerow(rows_by_slug[s])

    print("Article 29 updated/appended successfully and CSV deduplicated.")

except Exception as e:
    print(f"Error updating article: {e}")
    sys.exit(1)
